============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0 -- /home/HDCharles/rhdev/bin/python3
cachedir: .pytest_cache
rootdir: /home/HDCharles/repos/llm-compressor
configfile: pyproject.toml
plugins: anyio-4.11.0
collecting ... collected 1 item

tests/e2e/vLLM/test_vllm.py::TestvLLM::test_vllm[/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/configs/fp4_nvfp4_moe.yaml] 2025-10-28T14:01:20.220385+0000 | set_up | INFO - ========== RUNNING ==============
2025-10-28T14:01:20.220511+0000 | set_up | INFO - Qwen3-VL-30B-A3B-Instruct-NVFP4
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/13 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 13/13 [00:00<00:00, 115.25it/s]Loading checkpoint shards: 100%|██████████| 13/13 [00:00<00:00, 115.10it/s]
neuralmagic/calibration LLM train
2025-10-28T14:01:27.453522+0000 | run_oneshot_for_e2e_testing | INFO - ONESHOT KWARGS
2025-10-28T14:01:31.331454+0000 | reset | INFO - Compression lifecycle reset
2025-10-28T14:01:31.331952+0000 | from_modifiers | INFO - Creating recipe from modifiers
2025-10-28T14:01:31.397765+0000 | initialize | INFO - Compression lifecycle initialized for 1 modifiers
2025-10-28T14:01:31.398497+0000 | IndependentPipeline | INFO - Inferred `SequentialPipeline` for `QuantizationModifier`
2025-10-28T14:01:31.889166+0000 | trace_subgraphs | WARNING - Expected 75 subgraphs, but only traced 49. This is likely due to having wrapped code which calls sequential targets
Updating global scales:   0%|          | 0/356 [00:00<?, ?it/s]Updating global scales:   8%|▊         | 27/356 [00:00<00:01, 263.59it/s]Updating global scales:  22%|██▏       | 77/356 [00:00<00:00, 400.60it/s]Updating global scales:  33%|███▎      | 118/356 [00:00<00:00, 378.39it/s]Updating global scales:  47%|████▋     | 169/356 [00:00<00:00, 426.87it/s]Updating global scales:  62%|██████▏   | 221/356 [00:00<00:00, 458.21it/s]Updating global scales:  76%|███████▋  | 272/356 [00:00<00:00, 473.09it/s]Updating global scales:  92%|█████████▏| 327/356 [00:00<00:00, 494.62it/s]Updating global scales: 100%|██████████| 356/356 [00:00<00:00, 459.53it/s]
Fusing global scales: 0it [00:00, ?it/s]Fusing global scales: 1088it [00:00, 10697.75it/s]Fusing global scales: 1689it [00:00, 8461.37it/s] 
Calibrating weights:   0%|          | 0/356 [00:00<?, ?it/s]Calibrating weights:   4%|▍         | 15/356 [00:00<00:02, 147.43it/s]Calibrating weights:  10%|█         | 36/356 [00:00<00:01, 181.58it/s]Calibrating weights:  16%|█▋        | 58/356 [00:00<00:01, 197.98it/s]Calibrating weights:  22%|██▏       | 80/356 [00:00<00:01, 203.10it/s]Calibrating weights:  29%|██▊       | 102/356 [00:00<00:01, 208.18it/s]Calibrating weights:  35%|███▍      | 123/356 [00:00<00:01, 171.92it/s]Calibrating weights:  41%|████      | 145/356 [00:00<00:01, 184.95it/s]Calibrating weights:  47%|████▋     | 167/356 [00:00<00:00, 194.73it/s]Calibrating weights:  53%|█████▎    | 190/356 [00:00<00:00, 202.61it/s]Calibrating weights:  60%|█████▉    | 212/356 [00:01<00:00, 204.47it/s]Calibrating weights:  66%|██████▌   | 234/356 [00:01<00:00, 208.70it/s]Calibrating weights:  72%|███████▏  | 256/356 [00:01<00:00, 209.77it/s]Calibrating weights:  78%|███████▊  | 278/356 [00:01<00:00, 209.48it/s]Calibrating weights:  84%|████████▍ | 300/356 [00:01<00:00, 210.29it/s]Calibrating weights:  90%|█████████ | 322/356 [00:01<00:00, 211.59it/s]Calibrating weights:  97%|█████████▋| 345/356 [00:01<00:00, 212.60it/s]Calibrating weights: 100%|██████████| 356/356 [00:01<00:00, 202.54it/s]
Preparing cache:   0%|          | 0/20 [00:00<?, ?it/s]Preparing cache:  15%|█▌        | 3/20 [00:00<00:00, 29.61it/s]Preparing cache: 100%|██████████| 20/20 [00:00<00:00, 154.10it/s]
(1/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](1/49): Calibrating:   5%|▌         | 1/20 [00:01<00:32,  1.70s/it](1/49): Calibrating:  30%|███       | 6/20 [00:01<00:03,  4.41it/s](1/49): Calibrating:  60%|██████    | 12/20 [00:01<00:00,  9.82it/s](1/49): Calibrating:  90%|█████████ | 18/20 [00:02<00:00, 15.86it/s](1/49): Calibrating: 100%|██████████| 20/20 [00:02<00:00,  9.75it/s]
(1/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](1/49): Propagating:  70%|███████   | 14/20 [00:00<00:00, 133.60it/s](1/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 134.70it/s]
(2/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](2/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.56it/s](2/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 53.57it/s](2/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 54.54it/s]
(2/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](2/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.35it/s](2/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.05it/s]
(3/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](3/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.63it/s](3/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 54.42it/s](3/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 55.40it/s]
(3/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](3/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.40it/s](3/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.86it/s]
(4/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](4/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.63it/s](4/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 56.87it/s](4/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 55.52it/s]
(4/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](4/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.23it/s](4/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.91it/s]
(5/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](5/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.51it/s](5/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 53.60it/s](5/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 54.58it/s]
(5/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](5/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.21it/s](5/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.84it/s]
(6/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](6/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.59it/s](6/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 53.33it/s](6/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 54.56it/s]
(6/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](6/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.40it/s](6/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.82it/s]
(7/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](7/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.58it/s](7/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 56.51it/s](7/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 55.19it/s]
(7/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](7/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.24it/s](7/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.63it/s]
(8/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](8/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.61it/s](8/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 54.16it/s](8/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 55.11it/s]
(8/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](8/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.50it/s](8/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.89it/s]
(9/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](9/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  4.60it/s](9/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 54.19it/s](9/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 55.26it/s]
(9/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](9/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 146.71it/s](9/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.70it/s]
(10/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](10/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.92it/s](10/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.03it/s](10/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.74it/s]
(10/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](10/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.60it/s](10/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.46it/s]
(11/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](11/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.91it/s](11/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 58.86it/s](11/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.48it/s]
(11/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](11/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.75it/s](11/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.15it/s]
(12/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](12/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.90it/s](12/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.25it/s](12/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.28it/s]
(12/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](12/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 141.86it/s](12/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.14it/s]
(13/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](13/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.91it/s](13/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.30it/s](13/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.31it/s]
(13/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](13/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.63it/s](13/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.08it/s]
(14/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](14/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.91it/s](14/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 55.91it/s](14/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 56.96it/s]
(14/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](14/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.46it/s](14/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.82it/s]
(15/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](15/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.94it/s](15/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.21it/s](15/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.83it/s]
(15/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](15/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.92it/s](15/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.70it/s]
(16/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](16/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.88it/s](16/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.27it/s](16/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.28it/s]
(16/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](16/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.70it/s](16/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.51it/s]
(17/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](17/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.83it/s](17/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 55.34it/s](17/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 56.45it/s]
(17/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](17/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.34it/s](17/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.25it/s]
(18/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](18/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.93it/s](18/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.28it/s](18/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.96it/s]
(18/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](18/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 146.52it/s](18/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.36it/s]
(19/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](19/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.92it/s](19/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.44it/s](19/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.47it/s]
(19/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](19/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.53it/s](19/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.93it/s]
(20/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](20/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.94it/s](20/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.64it/s](20/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.55it/s]
(20/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](20/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.19it/s](20/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.80it/s]
(21/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](21/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.94it/s](21/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.26it/s](21/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.92it/s]
(21/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](21/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 146.40it/s](21/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 148.17it/s]
(22/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](22/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.89it/s](22/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.20it/s](22/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.31it/s]
(22/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](22/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 146.17it/s](22/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.87it/s]
(23/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](23/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.00it/s](23/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.66it/s](23/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 58.34it/s]
(23/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](23/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.71it/s](23/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.68it/s]
(24/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](24/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.92it/s](24/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.06it/s](24/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.72it/s]
(24/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](24/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 142.63it/s](24/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.02it/s]
(25/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](25/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.91it/s](25/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.05it/s](25/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.60it/s]
(25/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](25/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.34it/s](25/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.07it/s]
(26/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](26/49): Calibrating:   5%|▌         | 1/20 [00:00<00:04,  3.98it/s](26/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 49.63it/s](26/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 50.53it/s]
(26/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](26/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 131.49it/s](26/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 136.00it/s]
(27/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](27/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.93it/s](27/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 58.98it/s](27/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.50it/s]
(27/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](27/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 141.61it/s](27/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 143.86it/s]
(28/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](28/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.98it/s](28/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.89it/s](28/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.56it/s]
(28/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](28/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.39it/s](28/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.64it/s]
(29/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](29/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.93it/s](29/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.01it/s](29/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.66it/s]
(29/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](29/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 141.65it/s](29/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.11it/s]
(30/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](30/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.95it/s](30/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.21it/s](30/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.89it/s]
(30/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](30/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 147.04it/s](30/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 148.20it/s]
(31/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](31/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.94it/s](31/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.27it/s](31/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.34it/s]
(31/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](31/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.02it/s](31/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.85it/s]
(32/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](32/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.90it/s](32/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.22it/s](32/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.22it/s]
(32/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](32/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.77it/s](32/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.74it/s]
(33/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](33/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.01it/s](33/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 59.59it/s](33/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 58.33it/s]
(33/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](33/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 146.05it/s](33/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.75it/s]
(34/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](34/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.12it/s](34/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 60.34it/s](34/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 58.88it/s]
(34/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](34/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 141.37it/s](34/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 143.58it/s]
(35/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](35/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.00it/s](35/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.84it/s](35/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.83it/s]
(35/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](35/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 142.37it/s](35/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 143.69it/s]
(36/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](36/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.18it/s](36/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.75it/s](36/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 58.19it/s]
(36/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](36/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.36it/s](36/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.02it/s]
(37/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](37/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.14it/s](37/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 60.58it/s](37/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 59.29it/s]
(37/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](37/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 147.19it/s](37/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 148.68it/s]
(38/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](38/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.25it/s](38/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 61.15it/s](38/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 59.86it/s]
(38/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](38/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.74it/s](38/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.60it/s]
(39/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](39/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.35it/s](39/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 61.86it/s](39/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.56it/s]
(39/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](39/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.57it/s](39/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.60it/s]
(40/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](40/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.31it/s](40/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 58.96it/s](40/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 59.95it/s]
(40/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](40/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.47it/s](40/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.53it/s]
(41/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](41/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.32it/s](41/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 59.03it/s](41/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.09it/s]
(41/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](41/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 142.40it/s](41/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.53it/s]
(42/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](42/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.36it/s](42/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 61.77it/s](42/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.45it/s]
(42/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](42/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.86it/s](42/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.44it/s]
(43/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](43/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.37it/s](43/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 59.29it/s](43/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.01it/s]
(43/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](43/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.71it/s](43/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.29it/s]
(44/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](44/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  4.99it/s](44/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 56.47it/s](44/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 57.24it/s]
(44/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](44/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 144.16it/s](44/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.64it/s]
(45/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](45/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.31it/s](45/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 61.51it/s](45/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.22it/s]
(45/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](45/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 143.27it/s](45/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 145.40it/s]
(46/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](46/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.30it/s](46/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 61.46it/s](46/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.19it/s]
(46/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](46/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.85it/s](46/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 147.57it/s]
(47/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](47/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.39it/s](47/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 59.02it/s](47/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.25it/s]
(47/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](47/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 145.77it/s](47/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 146.75it/s]
(48/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](48/49): Calibrating:   5%|▌         | 1/20 [00:00<00:03,  5.40it/s](48/49): Calibrating:  75%|███████▌  | 15/20 [00:00<00:00, 62.28it/s](48/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 60.94it/s]
(48/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](48/49): Propagating:  75%|███████▌  | 15/20 [00:00<00:00, 141.99it/s](48/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 144.55it/s]
(49/49): Calibrating:   0%|          | 0/20 [00:00<?, ?it/s](49/49): Calibrating:  70%|███████   | 14/20 [00:00<00:00, 138.86it/s](49/49): Calibrating: 100%|██████████| 20/20 [00:00<00:00, 189.54it/s]
(49/49): Propagating:   0%|          | 0/20 [00:00<?, ?it/s](49/49): Propagating: 100%|██████████| 20/20 [00:00<00:00, 1937.01it/s]
2025-10-28T14:02:15.765071+0000 | finalize | INFO - Compression lifecycle finalized for 1 modifiers
2025-10-28T14:02:15.848686+0000 | post_process | WARNING - Optimized model is not saved. To save, please provide`output_dir` as input arg.Ex. `oneshot(..., output_dir=...)`
2025-10-28T14:02:15.849635+0000 | test_vllm | INFO - ================= SAVING TO DISK ======================
2025-10-28T14:02:15.849773+0000 | get_model_compressor | INFO - skip_sparsity_compression_stats set to True. Skipping sparsity compression statistic calculations. No sparsity compressor will be applied.
Compressing model: 0it [00:00, ?it/s]Compressing model: 1it [00:05,  5.83s/it]Compressing model: 7it [00:05,  1.59it/s]Compressing model: 12it [00:06,  3.17it/s]Compressing model: 17it [00:06,  5.25it/s]Compressing model: 23it [00:06,  8.46it/s]Compressing model: 28it [00:06, 11.68it/s]Compressing model: 33it [00:06, 15.47it/s]Compressing model: 39it [00:06, 20.79it/s]Compressing model: 44it [00:06, 24.96it/s]Compressing model: 49it [00:06, 29.31it/s]Compressing model: 55it [00:06, 34.60it/s]Compressing model: 61it [00:07, 38.30it/s]Compressing model: 67it [00:07, 42.05it/s]Compressing model: 73it [00:07, 43.47it/s]Compressing model: 79it [00:07, 46.50it/s]Compressing model: 85it [00:07, 47.16it/s]Compressing model: 91it [00:07, 48.45it/s]Compressing model: 97it [00:07, 48.56it/s]Compressing model: 103it [00:07, 50.36it/s]Compressing model: 109it [00:08, 41.79it/s]Compressing model: 114it [00:08, 28.00it/s]Compressing model: 118it [00:08, 25.53it/s]Compressing model: 122it [00:08, 27.75it/s]Compressing model: 127it [00:08, 31.27it/s]Compressing model: 132it [00:08, 34.20it/s]Compressing model: 137it [00:09, 37.12it/s]Compressing model: 142it [00:09, 39.56it/s]Compressing model: 147it [00:09, 41.38it/s]Compressing model: 152it [00:09, 42.25it/s]Compressing model: 157it [00:09, 42.55it/s]Compressing model: 162it [00:09, 43.62it/s]Compressing model: 167it [00:09, 44.29it/s]Compressing model: 172it [00:09, 44.72it/s]Compressing model: 177it [00:09, 45.13it/s]Compressing model: 182it [00:10, 45.56it/s]Compressing model: 187it [00:10, 45.74it/s]Compressing model: 192it [00:10, 45.08it/s]Compressing model: 197it [00:10, 45.38it/s]Compressing model: 202it [00:10, 45.54it/s]Compressing model: 207it [00:10, 45.49it/s]Compressing model: 212it [00:10, 45.74it/s]Compressing model: 217it [00:10, 45.78it/s]Compressing model: 222it [00:10, 45.82it/s]Compressing model: 227it [00:11, 45.80it/s]Compressing model: 232it [00:11, 45.92it/s]Compressing model: 237it [00:11, 45.98it/s]Compressing model: 242it [00:11, 45.95it/s]Compressing model: 247it [00:11, 46.16it/s]Compressing model: 252it [00:11, 45.26it/s]Compressing model: 257it [00:11, 44.74it/s]Compressing model: 262it [00:11, 45.11it/s]Compressing model: 267it [00:11, 45.47it/s]Compressing model: 272it [00:12, 45.71it/s]Compressing model: 277it [00:12, 45.66it/s]Compressing model: 282it [00:12, 45.71it/s]Compressing model: 287it [00:12, 45.35it/s]Compressing model: 292it [00:12, 45.50it/s]Compressing model: 297it [00:12, 43.54it/s]Compressing model: 302it [00:12, 44.15it/s]Compressing model: 307it [00:12, 44.63it/s]Compressing model: 312it [00:12, 44.86it/s]Compressing model: 317it [00:13, 44.22it/s]Compressing model: 322it [00:13, 44.66it/s]Compressing model: 327it [00:13, 44.94it/s]Compressing model: 332it [00:13, 45.09it/s]Compressing model: 337it [00:13, 45.26it/s]Compressing model: 342it [00:13, 44.90it/s]Compressing model: 347it [00:13, 45.16it/s]Compressing model: 352it [00:13, 45.52it/s]Compressing model: 356it [00:13, 25.69it/s]
2025-10-28T14:07:49.943370+0000 | reset | INFO - Compression lifecycle reset
2025-10-28T14:07:49.943804+0000 | _run_vllm | INFO - Run vllm in subprocess.Popen() using python env:
2025-10-28T14:07:49.943849+0000 | _run_vllm | INFO - /home/HDCharles/rhdev/bin/python3
2025-10-28T14:08:10.166190+0000 | _run_vllm | INFO - INFO 10-28 14:07:52 [__init__.py:216] Automatically detected platform cuda.
INFO 10-28 14:07:53 [utils.py:233] non-default args: {'disable_log_stats': True, 'model': 'Qwen3-VL-30B-A3B-Instruct-NVFP4'}
INFO 10-28 14:07:53 [model.py:547] Resolved architecture: Qwen3VLMoeForConditionalGeneration
INFO 10-28 14:07:54 [model.py:1510] Using max model len 262144
INFO 10-28 14:07:55 [scheduler.py:205] Chunked prefill is enabled with max_num_batched_tokens=16384.
INFO 10-28 14:07:58 [__init__.py:216] Automatically detected platform cuda.
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:00 [core.py:644] Waiting for init message from front-end.
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:00 [core.py:77] Initializing a V1 LLM engine (v0.11.0) with config: model='Qwen3-VL-30B-A3B-Instruct-NVFP4', speculative_config=None, tokenizer='Qwen3-VL-30B-A3B-Instruct-NVFP4', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=262144, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=Qwen3-VL-30B-A3B-Instruct-NVFP4, enable_prefix_caching=True, chunked_prefill_enabled=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2","vllm.mamba_mixer","vllm.short_conv","vllm.linear_attention","vllm.plamo2_mamba_mixer","vllm.gdn_attention","vllm.sparse_attn_indexer"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":[2,1],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"use_inductor_graph_partition":false,"pass_config":{},"max_capture_size":512,"local_cache_dir":null}
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:01 [parallel_state.py:1208] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:02 [topk_topp_sampler.py:55] Using FlashInfer for top-p & top-k sampling.
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:07 [gpu_model_runner.py:2602] Starting to load model Qwen3-VL-30B-A3B-Instruct-NVFP4...
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:07 [gpu_model_runner.py:2634] Loading model from scratch...
[1;36m(EngineCore_DP0 pid=105533)[0;0m WARNING 10-28 14:08:07 [compressed_tensors.py:490] Current platform does not support cutlass NVFP4. Running CompressedTensorsW4A16Fp4.
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:07 [cuda.py:366] Using Flash Attention backend on V1 engine.
[1;36m(EngineCore_DP0 pid=105533)[0;0m INFO 10-28 14:08:07 [nvfp4_moe_support.py:49] Falling back to Marlin FP4 MoE kernel.
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708] EngineCore failed to start.
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708] Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 699, in run_engine_core
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 498, in __init__
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     super().__init__(vllm_config, executor_class, log_stats,
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 83, in __init__
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 54, in __init__
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self._init_executor()
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 55, in _init_executor
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self.collective_rpc("load_model")
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 83, in collective_rpc
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     return [run_method(self.driver_worker, method, args, kwargs)]
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/utils/__init__.py", line 3122, in run_method
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 213, in load_model
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self.model_runner.load_model(eep_scale_up=eep_scale_up)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2635, in load_model
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self.model = model_loader.load_model(
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                  ^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/model_loader/base_loader.py", line 50, in load_model
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     self.load_weights(model, model_config)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/model_loader/default_loader.py", line 264, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     loaded_weights = model.load_weights(
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl.py", line 1603, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     return loader.load_weights(weights, mapper=self.hf_to_vllm_mapper)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 294, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     autoloaded_weights = set(self._load_module("", self.module, weights))
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 252, in _load_module
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     yield from self._load_module(prefix,
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 225, in _load_module
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     loaded_params = module_load_weights(weights)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_moe.py", line 689, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     return loader.load_weights(weights)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 294, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     autoloaded_weights = set(self._load_module("", self.module, weights))
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 252, in _load_module
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     yield from self._load_module(prefix,
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 225, in _load_module
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     loaded_params = module_load_weights(weights)
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl_moe.py", line 231, in load_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     success = self.load_fused_expert_weights(
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl_moe.py", line 126, in load_fused_expert_weights
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]     param = params_dict[name]
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708]             ~~~~~~~~~~~^^^^^^
[1;36m(EngineCore_DP0 pid=105533)[0;0m ERROR 10-28 14:08:08 [core.py:708] KeyError: 'layers.0.mlp.experts.w2_weight'

FAILED

=================================== FAILURES ===================================
_ TestvLLM.test_vllm[/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/configs/fp4_nvfp4_moe.yaml] _

self = <tests.e2e.vLLM.test_vllm.TestvLLM object at 0x7fb845f47110>
test_data_file = '/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/configs/fp4_nvfp4_moe.yaml'

    def test_vllm(self, test_data_file: str):
        # Run vLLM with saved model
    
        self.set_up(test_data_file)
        if not self.save_dir:
            self.save_dir = self.model.split("/")[1] + f"-{self.scheme}"
        oneshot_model, tokenizer = run_oneshot_for_e2e_testing(
            model=self.model,
            model_class=self.model_class,
            num_calibration_samples=self.num_calibration_samples,
            max_seq_length=self.max_seq_length,
            scheme=self.scheme,
            dataset_id=self.dataset_id,
            dataset_config=self.dataset_config,
            dataset_split=self.dataset_split,
            recipe=self.recipe,
            quant_type=self.quant_type,
        )
    
        # check that session contains recipe
        self._check_session_contains_recipe()
    
        logger.info("================= SAVING TO DISK ======================")
        self._save_compressed_model(oneshot_model=oneshot_model, tokenizer=tokenizer)
    
        recipe_path = os.path.join(self.save_dir, "recipe.yaml")
    
        # check that expected files exist
        self._check_save_dir_has_expected_files()
    
        # Use the session to fetch the recipe;
        # Reset session for next test case
        session = active_session()
        recipe_yaml_str = session.get_serialized_recipe()
        with open(recipe_path, "w") as fp:
            fp.write(recipe_yaml_str)
        session.reset()
    
        # if SKIP_HF_UPLOAD.lower() != "yes":
        #     logger.info("================= UPLOADING TO HUB ======================")
    
        #     stub = f"{HF_MODEL_HUB_NAME}/{self.save_dir}-e2e"
    
        #     self.api.create_repo(
        #         repo_id=stub,
        #         exist_ok=True,
        #         repo_type="model",
        #         private=False,
        #     )
    
        #     self.api.upload_folder(
        #         repo_id=stub,
        #         folder_path=self.save_dir,
        #     )
    
        # if VLLM_PYTHON_ENV.lower() == "same":
        #     logger.info("========== RUNNING vLLM in the same python env ==========")
        # else:
        #     logger.info("========== RUNNING vLLM in a separate python env ==========")
    
>       self._run_vllm(logger)

tests/e2e/vLLM/test_vllm.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/test_timer/timer_utils.py:33: in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tests.e2e.vLLM.test_vllm.TestvLLM object at 0x7fb845f47110>
logger = <loguru.logger handlers=[(id=2, level=20, sink=<stdout>)]>

    @log_time
    def _run_vllm(self, logger):
        import json
        import subprocess
    
        llm_kwargs = {"model": self.save_dir}
    
        if self.gpu_memory_utilization is not None:
            llm_kwargs["gpu_memory_utilization"] = self.gpu_memory_utilization
    
        json_scheme = json.dumps(self.scheme)
        json_llm_kwargs = json.dumps(llm_kwargs)
        json_prompts = json.dumps(self.prompts)
    
        test_file_dir = os.path.dirname(os.path.abspath(__file__))
        run_file_path = os.path.join(test_file_dir, "run_vllm.py")
    
        logger.info("Run vllm in subprocess.Popen() using python env:")
        logger.info(self.vllm_env)
    
        result = subprocess.Popen(
            [self.vllm_env, run_file_path, json_scheme, json_llm_kwargs, json_prompts],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True,
        )
        stdout, stderr = result.communicate()
        logger.info(stdout)
    
        error_msg = f"ERROR: vLLM failed with exit code {result.returncode}: {stderr}"
>       assert result.returncode == 0, error_msg
E       AssertionError: ERROR: vLLM failed with exit code 1: `torch_dtype` is deprecated! Use `dtype` instead!
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m 
E         Loading safetensors checkpoint shards:   0% Completed | 0/13 [00:00<?, ?it/s]
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m Process EngineCore_DP0:
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m Traceback (most recent call last):
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.run()
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/multiprocessing/process.py", line 108, in run
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self._target(*self._args, **self._kwargs)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 712, in run_engine_core
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     raise e
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 699, in run_engine_core
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 498, in __init__
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     super().__init__(vllm_config, executor_class, log_stats,
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 83, in __init__
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.model_executor = executor_class(vllm_config)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/executor_base.py", line 54, in __init__
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self._init_executor()
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 55, in _init_executor
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.collective_rpc("load_model")
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py", line 83, in collective_rpc
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     return [run_method(self.driver_worker, method, args, kwargs)]
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/utils/__init__.py", line 3122, in run_method
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     return func(*args, **kwargs)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 213, in load_model
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.model_runner.load_model(eep_scale_up=eep_scale_up)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2635, in load_model
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.model = model_loader.load_model(
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                  ^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/model_loader/base_loader.py", line 50, in load_model
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     self.load_weights(model, model_config)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/model_loader/default_loader.py", line 264, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     loaded_weights = model.load_weights(
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                      ^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl.py", line 1603, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     return loader.load_weights(weights, mapper=self.hf_to_vllm_mapper)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 294, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     autoloaded_weights = set(self._load_module("", self.module, weights))
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 252, in _load_module
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     yield from self._load_module(prefix,
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 225, in _load_module
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     loaded_params = module_load_weights(weights)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_moe.py", line 689, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     return loader.load_weights(weights)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 294, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     autoloaded_weights = set(self._load_module("", self.module, weights))
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 252, in _load_module
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     yield from self._load_module(prefix,
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/utils.py", line 225, in _load_module
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     loaded_params = module_load_weights(weights)
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl_moe.py", line 231, in load_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     success = self.load_fused_expert_weights(
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m   File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/model_executor/models/qwen3_vl_moe.py", line 126, in load_fused_expert_weights
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m     param = params_dict[name]
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m             ~~~~~~~~~~~^^^^^^
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m KeyError: 'layers.0.mlp.experts.w2_weight'
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m 
E         Loading safetensors checkpoint shards:   0% Completed | 0/13 [00:00<?, ?it/s]
E         [1;36m(EngineCore_DP0 pid=105533)[0;0m 
E         [rank0]:[W1028 14:08:08.283099506 ProcessGroupNCCL.cpp:1538] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
E         Traceback (most recent call last):
E           File "/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/run_vllm.py", line 51, in <module>
E             main()
E           File "/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/run_vllm.py", line 47, in main
E             run_vllm(llm_kwargs, prompts)
E           File "/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/run_vllm.py", line 32, in run_vllm
E             llm = LLM(**llm_kwargs)
E                   ^^^^^^^^^^^^^^^^^
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 297, in __init__
E             self.llm_engine = LLMEngine.from_engine_args(
E                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/llm_engine.py", line 177, in from_engine_args
E             return cls(vllm_config=vllm_config,
E                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/llm_engine.py", line 114, in __init__
E             self.engine_core = EngineCoreClient.make_client(
E                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core_client.py", line 80, in make_client
E             return SyncMPClient(vllm_config, executor_class, log_stats)
E                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core_client.py", line 602, in __init__
E             super().__init__(
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/core_client.py", line 448, in __init__
E             with launch_core_engines(vllm_config, executor_class,
E           File "/home/HDCharles/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/contextlib.py", line 144, in __exit__
E             next(self.gen)
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/utils.py", line 732, in launch_core_engines
E             wait_for_engine_startup(
E           File "/home/HDCharles/rhdev/lib/python3.11/site-packages/vllm/v1/engine/utils.py", line 785, in wait_for_engine_startup
E             raise RuntimeError("Engine core initialization failed. "
E         RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
E         
E       assert 1 == 0
E        +  where 1 = <Popen: returncode: 1 args: ['/home/HDCharles/rhdev/bin/python3', '/home/HDC...>.returncode

tests/e2e/vLLM/test_vllm.py:216: AssertionError
=========================== short test summary info ============================
FAILED tests/e2e/vLLM/test_vllm.py::TestvLLM::test_vllm[/home/HDCharles/repos/llm-compressor/tests/e2e/vLLM/configs/fp4_nvfp4_moe.yaml]
======================== 1 failed in 415.01s (0:06:55) =========================
